# typedef 声明

可以使用 **typedef** 为一个已有的类型取一个新的名字。

```c++
typedef type newname; 
```

下面的语句会告诉编译器，feet 是 int 的另一个名称：

```c++
typedef int feet;
```

现在，下面的声明是完全合法的，它创建了一个整型变量 distance：

```c++
feet distance;
```





# 关于 typedef 的几点说明：

* typedef 可以声明各种类型名，但不能用来定义变量。
* 用typedef只是对已经存在的类型增加一个类型名，而没有创造新的类型
* 当在不同源文件中用到同一类型数据（尤其是像数组、指针、结构体、共用体等类型数据）时，常用 typedef 声明一些数据类型，把它们单独放在一个头文件中，然后在需要用到它们的文件中用 ＃include 命令把它们包含进来，以提高编程效率。
* 使用 typedef 有利于程序的通用与移植。有时程序会依赖于硬件特性，用 typedef 便于移植。





# 有关typedef 与 #define 的区别

* 执行时间不同

  * 关键字 typedef 在编译阶段有效，由于是在编译阶段，因此 typedef 有类型检查的功能。
  * \#define 则是宏定义，发生在预处理阶段，也就是编译之前，它只进行简单而机械的字符串替换，而不进行任何检查。所以它没有typedef 来的稳健

* 功能有差异

  * typedef 用来定义类型的别名，定义与平台无关的数据类型，与 结构体的结合使用等。

    

    比如定义一个叫 FALSE 的浮点类型，在目标平台一上，让它表示最高精度的类型为：

    ```c++
    typedef long double FALSE; 
    ```

    在不支持 long double 的平台二上，改为

    ```c++
    typedef double FALSE; 
    ```

    在连 double 都不支持的平台三上，改为：

    ```c++
    typedef float FALSE; 
    ```

    也就是说，当跨平台时，只要改下 typedef 本身就行，不用对其他源码做任何修改。标准库就广泛使用了这个技巧

    

  * \#define 不只是可以为类型取别名，还可以定义常量、变量、编译开关等。

* 作用域不同

  * \#define 没有作用域的限制，只要是之前预定义过的宏，在以后的程序中都可以使用。

  * typedef 有自己的作用域

    ```c++
    void func1()
    {
        typedef unsigned int UINT;
    }
     
    void func2()
    {
        UINT uValue = 5;//error C2065: 'UINT' : undeclared identifier
    }
    ```

* 二者修饰指针类型时，作用不同

  ```c++
  typedef int * pint;
  #define PINT int *
   
  int i1 = 1, i2 = 2;
   
  const pint p1 = &i1;    //p不可更改，p指向的内容可以更改，相当于 int * const p;
  const PINT p2 = &i2;    //p可以更改，p指向的内容不能更改，相当于 const int *p；或 int const *p；
   
  pint s1, s2;    //s1和s2都是int型指针
  PINT s3, s4;    //相当于int * s3，s4；只有一个是指针。
   
  void TestPointer()
  {
      cout << "p1:" << p1 << "  *p1:" << *p1 << endl;
      //p1 = &i2; //error C3892: 'p1' : you cannot assign to a variable that is const
      *p1 = 5;
      cout << "p1:" << p1 << "  *p1:" << *p1 << endl;
   
      cout << "p2:" << p2 << "  *p2:" << *p2 << endl;
      //*p2 = 10; //error C3892: 'p2' : you cannot assign to a variable that is const
      p2 = &i1;
      cout << "p2:" << p2 << "  *p2:" << *p2 << endl;
  }
  ```

  结果：

  ```c++
  p1:00EFD094  *p1:1
  p1:00EFD094  *p1:5
  p2:00EFD098  *p2:2
  p2:00EFD094  *p2:5
  ```

  
